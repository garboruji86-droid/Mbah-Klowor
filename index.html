<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MbahKlowor Voice Over AI</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: #070709;
            color: white;
            -webkit-font-smoothing: antialiased;
        }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.05); border-radius: 10px; }
        
        input[type='range'] {
            -webkit-appearance: none;
            appearance: none;
            background: rgba(255,255,255,0.05);
            border-radius: 999px;
        }
        input[type='range']::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: #f97316;
            border: 3px solid #0f0f13;
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(249,115,22,0.3);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        /**
         * Komponen Ikon yang diperbaiki
         * Menggunakan lucide.createIcons untuk keamanan kompatibilitas
         */
        const Icon = ({ name, size = 20, className = "" }) => {
            const iconRef = useRef(null);
            
            useEffect(() => {
                if (window.lucide && iconRef.current) {
                    // Konversi CamelCase ke kebab-case untuk data-lucide attribute
                    const lucideName = name.replace(/([a-z0-9])([A-Z])/g, '$1-$2').toLowerCase();
                    iconRef.current.setAttribute('data-lucide', lucideName);
                    iconRef.current.setAttribute('width', size);
                    iconRef.current.setAttribute('height', size);
                    
                    window.lucide.createIcons({
                        attrs: {
                            class: className,
                            'stroke-width': 2
                        }
                    });
                }
            }, [name, size, className]);

            return <i ref={iconRef} className={className} style={{ width: size, height: size, display: 'inline-block' }}></i>;
        };

        const App = () => {
            const [text, setText] = useState('');
            const [language, setLanguage] = useState('id-ID');
            const [dialect, setDialect] = useState('Standar');
            const [gender, setGender] = useState('Pria');
            const [style, setStyle] = useState('santai');
            const [emotion, setEmotion] = useState('normal');
            const [speed, setSpeed] = useState(1.0);
            const [isGenerating, setIsGenerating] = useState(false);
            const [audioUrl, setAudioUrl] = useState(null);
            const [isPlaying, setIsPlaying] = useState(false);
            const [errorMessage, setErrorMessage] = useState(null);
            const audioRef = useRef(null);

            const apiKey = "AIzaSyC8fG02j4uZUqwagaI2VI99IxTmpnudQyM"; 

            const voices = {
                Pria: ["Zephyr", "Puck", "Charon", "Fenrir", "Orus"],
                Wanita: ["Kore", "Leda", "Aoede", "Callirrhoe", "Autonoe"]
            };

            const dialects = {
                'id-ID': ['Standar', 'Logat Jawa', 'Logat Sunda'],
                'en-US': ['Inggris US', 'Inggris British', 'Inggris Australia', 'Inggris India']
            };

            const styles = ['santai', 'cerita', 'dramatis', 'formal', 'reflektif', 'inspiratif'];
            const emotions = ['normal', 'tertawa', 'menangis', 'berbisik', 'sedih', 'ceria'];

            const fetchWithRetry = async (url, options, retries = 5, backoff = 1000) => {
                try {
                    const response = await fetch(url, options);
                    if (!response.ok) {
                        if (retries > 0 && (response.status === 429 || response.status >= 500)) {
                            await new Promise(resolve => setTimeout(resolve, backoff));
                            return fetchWithRetry(url, options, retries - 1, backoff * 2);
                        }
                        throw new Error(`API Error: ${response.status}`);
                    }
                    return response;
                } catch (err) {
                    if (retries > 0) {
                        await new Promise(resolve => setTimeout(resolve, backoff));
                        return fetchWithRetry(url, options, retries - 1, backoff * 2);
                    }
                    throw err;
                }
            };

            const createAudioBlob = (pcmData, sampleRate = 24000) => {
                const buffer = new ArrayBuffer(44 + pcmData.length * 2);
                const view = new DataView(buffer);
                const writeString = (offset, string) => {
                    for (let i = 0; i < string.length; i++) {
                        view.setUint8(offset + i, string.charCodeAt(i));
                    }
                };
                writeString(0, 'RIFF');
                view.setUint32(4, 36 + pcmData.length * 2, true);
                writeString(8, 'WAVE');
                writeString(12, 'fmt ');
                view.setUint32(16, 16, true);
                view.setUint16(20, 1, true);
                view.setUint16(22, 1, true);
                view.setUint32(24, sampleRate, true);
                view.setUint32(28, sampleRate * 2, true);
                view.setUint16(32, 2, true);
                view.setUint16(34, 16, true);
                writeString(36, 'data');
                view.setUint32(40, pcmData.length * 2, true);
                let offset = 44;
                for (let i = 0; i < pcmData.length; i++, offset += 2) {
                    view.setInt16(offset, pcmData[i], true);
                }
                return new Blob([buffer], { type: 'audio/wav' });
            };

            const handleGenerate = async () => {
                if (!text) return;
                setIsGenerating(true);
                setAudioUrl(null);
                setErrorMessage(null);
                try {
                    const voiceList = voices[gender];
                    const voiceName = voiceList[Math.floor(Math.random() * voiceList.length)];
                    const langName = language === 'id-ID' ? 'Indonesia' : 'Inggris';
                    const dialectText = dialect !== 'Standar' ? ` dengan ${dialect}` : '';
                    const emotionText = emotion !== 'normal' ? ` dengan nada ${emotion}` : '';
                    const systemInstruction = `Bicaralah sebagai pengisi suara ${gender} dalam bahasa ${langName}. Gaya ${style}${dialectText}${emotionText}.`;
                    
                    const response = await fetchWithRetry(
                        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`, 
                        {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                contents: [{ parts: [{ text: `${systemInstruction} Narasi: ${text}` }] }],
                                generationConfig: {
                                    responseModalities: ["AUDIO"],
                                    speechConfig: {
                                        voiceConfig: {
                                            prebuiltVoiceConfig: { voiceName: voiceName }
                                        }
                                    }
                                }
                            })
                        }
                    );
                    const result = await response.json();
                    const base64Audio = result.candidates?.[0]?.content?.parts?.[0]?.inlineData?.data;
                    if (!base64Audio) throw new Error("Gagal mengambil audio.");
                    const binaryString = atob(base64Audio);
                    const pcmData = new Int16Array(binaryString.length / 2);
                    for (let i = 0; i < pcmData.length; i++) {
                        pcmData[i] = binaryString.charCodeAt(i * 2) | (binaryString.charCodeAt(i * 2 + 1) << 8);
                    }
                    const audioBlob = createAudioBlob(pcmData);
                    const url = URL.createObjectURL(audioBlob);
                    setAudioUrl(url);
                } catch (error) {
                    setErrorMessage("Gagal memproses suara. Coba lagi.");
                } finally {
                    setIsGenerating(false);
                }
            };

            const togglePlay = () => {
                if (!audioRef.current) return;
                if (isPlaying) { audioRef.current.pause(); } 
                else { 
                    audioRef.current.playbackRate = speed;
                    audioRef.current.play(); 
                }
                setIsPlaying(!isPlaying);
            };

            const downloadAudio = () => {
                if (!audioUrl) return;
                const link = document.createElement('a');
                link.href = audioUrl;
                link.download = `MbahKlowor_Voice_${Date.now()}.wav`;
                link.click();
            };

            return (
                <div className="min-h-screen p-4 md:p-8">
                    <div className="max-w-6xl mx-auto">
                        {/* Header */}
                        <header className="flex flex-col md:flex-row md:items-center justify-between gap-6 mb-12">
                            <div className="flex items-center gap-5">
                                <div className="w-14 h-14 bg-orange-600 rounded-2xl flex items-center justify-center shadow-2xl shadow-orange-500/30">
                                    <Icon name="Mic2" size={28} className="text-white" />
                                </div>
                                <div>
                                    <h1 className="text-3xl font-black uppercase leading-none">
                                        <span className="text-orange-500">Mbah</span>
                                        <span className="text-white">Klowor</span>
                                    </h1>
                                    <p className="text-[10px] font-bold text-white/60 uppercase tracking-[0.3em] mt-1 italic">Voice Over Studio</p>
                                </div>
                            </div>
                            <div className="flex items-center gap-3 px-5 py-2.5 bg-white/5 rounded-full border border-white/10 backdrop-blur-md">
                                <div className="w-2.5 h-2.5 rounded-full bg-orange-500 animate-pulse shadow-[0_0_10px_rgba(249,115,22,0.5)]" />
                                <span className="text-[11px] font-black uppercase text-white tracking-wider">MbahKlowor Engine Online</span>
                            </div>
                        </header>

                        <div className="grid grid-cols-1 lg:grid-cols-12 gap-10">
                            {/* Editor Area */}
                            <div className="lg:col-span-8 space-y-8">
                                <div className="relative bg-[#0f0f13] border border-white/10 rounded-[3rem] p-8 md:p-10 shadow-2xl overflow-hidden group">
                                    <textarea 
                                        className="w-full h-72 bg-transparent border-none focus:ring-0 text-xl md:text-2xl leading-relaxed placeholder:text-white/10 resize-none z-10 relative text-white"
                                        placeholder="Ketik narasi MbahKlowor di sini..."
                                        value={text}
                                        onChange={(e) => setText(e.target.value)}
                                        maxLength={1000}
                                    />
                                    <div className="flex flex-wrap justify-between items-center mt-6 border-t border-white/10 pt-8 z-10 relative gap-4">
                                        <span className="text-[10px] font-black text-white/40 uppercase tracking-widest">{text.length} / 1000</span>
                                        <div className="flex items-center gap-4">
                                            {errorMessage && (
                                                <div className="text-red-400 text-[10px] font-black uppercase flex items-center gap-2">
                                                    <Icon name="AlertCircle" size={14} /> {errorMessage}
                                                </div>
                                            )}
                                            <button 
                                                onClick={handleGenerate}
                                                disabled={isGenerating || !text}
                                                className="px-10 py-5 bg-orange-600 hover:bg-orange-500 disabled:opacity-20 text-white rounded-[1.5rem] font-black text-xs uppercase tracking-[0.2em] transition-all flex items-center gap-3 shadow-2xl shadow-orange-600/40 active:scale-95"
                                            >
                                                {isGenerating ? <Icon name="Loader2" className="animate-spin" /> : <Icon name="Wand2" />}
                                                Generate Voice
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                {audioUrl && (
                                    <div className="bg-gradient-to-br from-orange-900/10 to-transparent border border-orange-500/20 rounded-[3rem] p-10 animate-in fade-in slide-in-from-bottom-6 duration-700">
                                        <div className="flex flex-col md:flex-row items-center gap-10">
                                            <button onClick={togglePlay} className="w-20 h-20 bg-white text-black rounded-full flex items-center justify-center shadow-xl hover:scale-105 active:scale-90 transition-all">
                                                {isPlaying ? <Icon name="Pause" size={32} /> : <Icon name="Play" size={32} className="ml-1" />}
                                            </button>
                                            <div className="flex-1 w-full space-y-6">
                                                <div className="flex justify-between items-end">
                                                    <div className="space-y-1">
                                                        <div className="flex items-center gap-3 text-orange-500">
                                                            <Icon name="Waves" size={20} />
                                                            <span className="text-xs font-black uppercase tracking-[0.2em]">Output Ready</span>
                                                        </div>
                                                        <p className="text-[10px] font-bold text-white/50 uppercase italic">WAV Format &bull; Studio Quality</p>
                                                    </div>
                                                    <button onClick={downloadAudio} className="bg-white/5 hover:bg-white/10 text-white px-6 py-3 rounded-2xl border border-white/20 transition-all flex items-center gap-3">
                                                        <Icon name="Download" size={18} className="text-orange-500" />
                                                        <span className="text-[11px] font-black uppercase tracking-widest">Unduh WAV</span>
                                                    </button>
                                                </div>
                                                <div className="h-2.5 bg-white/5 rounded-full overflow-hidden relative">
                                                    <div className={`h-full bg-orange-600 ${isPlaying ? 'w-full transition-all duration-[15s] linear' : 'w-0'}`} />
                                                </div>
                                                <audio ref={audioRef} src={audioUrl} onEnded={() => setIsPlaying(false)} hidden />
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>

                            {/* Sidebar Area */}
                            <div className="lg:col-span-4 space-y-8">
                                <div className="bg-[#0f0f13] border border-white/10 rounded-[2.5rem] p-8 space-y-8">
                                    <div className="space-y-4">
                                        <div className="flex items-center gap-3 text-white/60">
                                            <Icon name="Languages" className="text-orange-500" />
                                            <span className="text-[11px] font-black uppercase tracking-[0.2em]">Bahasa</span>
                                        </div>
                                        <div className="grid grid-cols-2 gap-3">
                                            <button onClick={() => {setLanguage('id-ID'); setDialect('Standar');}} className={`py-4 rounded-2xl text-[10px] font-black uppercase tracking-widest transition-all border ${language === 'id-ID' ? 'bg-orange-600 border-orange-500 text-white shadow-lg' : 'bg-white/5 border-white/10 text-white/40'}`}>Indonesia</button>
                                            <button onClick={() => {setLanguage('en-US'); setDialect('Inggris US');}} className={`py-4 rounded-2xl text-[10px] font-black uppercase tracking-widest transition-all border ${language === 'en-US' ? 'bg-orange-600 border-orange-500 text-white shadow-lg' : 'bg-white/5 border-white/10 text-white/40'}`}>English</button>
                                        </div>
                                        <select value={dialect} onChange={(e) => setDialect(e.target.value)} className="w-full bg-black/40 border border-white/10 rounded-2xl py-4 px-5 text-xs font-black text-white outline-none cursor-pointer">
                                            {dialects[language].map(d => <option key={d} value={d} className="bg-[#0a0a0c]">{d}</option>)}
                                        </select>
                                    </div>

                                    <div className="space-y-4">
                                        <div className="flex items-center gap-3 text-white/60">
                                            <Icon name="Volume2" className="text-orange-500" />
                                            <span className="text-[11px] font-black uppercase tracking-[0.2em]">Karakter</span>
                                        </div>
                                                   const i = document.createElement('i');
                    i.setAttribute('data-lucide', name.toLowerCase());
                    i.className = className;
                    iconRef.current.appendChild(i);
                    window.lucide.createIcons({
                        attrs: { class: className },
                        nameAttr: 'data-lucide',
                        icons: window.lucide.icons
                    });
                }
            }, [name, className]);
            return <span ref={iconRef} className="inline-flex items-center justify-center"></span>;
        };

        const App = () => {
            const [text, setText] = useState('');
            const [isGenerating, setIsGenerating] = useState(false);
            const [style, setStyle] = useState('Storytelling');
            const [mainLang, setMainLang] = useState('Indonesia');
            const [subLang, setSubLang] = useState('Standar Indonesia');
            const [selectedVoice, setSelectedVoice] = useState('Puck'); 

            const [audioUrl, setAudioUrl] = useState(null);
            const [error, setError] = useState(null);
            const audioRef = useRef(null);
            const apiKey = "AIzaSyC8fG02j4uZUqwagaI2VI99IxTmpnudQyM"; 

            const languageMap = {
                'Indonesia': ['Standar Indonesia', 'Logat Jawa', 'Logat Sunda', 'Logat Melayu', 'Aksen Timur'],
                'English': ['US English', 'British English', 'Australian English', 'Indian English']
            };

            const voiceDatabase = {
                'Indonesia': [
                    { id: 'Puck', name: 'Budi (Pria)', type: 'Bariton Professional', avatar: 'ðŸ§”' },
                    { id: 'Kore', name: 'Siti (Wanita)', type: 'Ramah & Jelas', avatar: 'ðŸ‘©' },
                    { id: 'Charon', name: 'Eko (Pria)', type: 'Narasi Berat', avatar: 'ðŸ‘´' },
                    { id: 'Zephyr', name: 'Laras (Wanita)', type: 'Anggun & Lembut', avatar: 'ðŸ‘±â€â™€ï¸' },
                ],
                'English': [
                    { id: 'Fenrir', name: 'James (Male)', type: 'Deep US Narrative', avatar: 'ðŸ‡ºðŸ‡¸' },
                    { id: 'Aoede', name: 'Emma (Female)', type: 'Soft British Accent', avatar: 'ðŸ‡¬ðŸ‡§' },
                    { id: 'Iapetus', name: 'Robert (Male)', type: 'Energetic Broadcaster', avatar: 'ðŸŽ™ï¸' },
                    { id: 'Leda', name: 'Sophie (Female)', type: 'Elegant Corporate', avatar: 'ðŸ¢' },
                ]
            };

            const styles = [
                { name: 'Santai', icon: 'â˜•', prompt: 'relaxed and casual' },
                { name: 'Storytelling', icon: 'ðŸ“–', prompt: 'captivating storytelling, with dramatic pauses and expressive narration like a book narrator' },
                { name: 'Reflektif', icon: 'ðŸ§˜', prompt: 'deep, thoughtful, calm, and reflective with a slow and meaningful pace' },
                { name: 'Dramatis', icon: 'ðŸŽ­', prompt: 'highly intense, emotional, and very dramatic' },
                { name: 'Inspiratif', icon: 'ðŸŒŸ', prompt: 'inspiring and motivational' },
                { name: 'Formal', icon: 'ðŸŽ™ï¸', prompt: 'formal, professional, and clear' },
            ];

            useEffect(() => {
                setSubLang(languageMap[mainLang][0]);
                setSelectedVoice(voiceDatabase[mainLang][0].id);
            }, [mainLang]);

            const encodeMp3 = (pcmData, sampleRate) => {
                if (!window.lamejs) return null;
                const mp3encoder = new window.lamejs.Mp3Encoder(1, sampleRate, 128);
                const mp3Data = [];
                const sampleBlockSize = 1152;
                for (let i = 0; i < pcmData.length; i += sampleBlockSize) {
                    const sampleChunk = pcmData.subarray(i, i + sampleBlockSize);
                    const mp3buf = mp3encoder.encodeBuffer(sampleChunk);
                    if (mp3buf.length > 0) mp3Data.push(mp3buf);
                }
                const mp3buf = mp3encoder.flush();
                if (mp3buf.length > 0) mp3Data.push(mp3buf);
                return new Blob(mp3Data, { type: 'audio/mp3' });
            };

            const generateVoice = async () => {
                if (!text) return;
                setIsGenerating(true);
                setError(null);
                setAudioUrl(null);

                const stylePrompt = styles.find(s => s.name === style)?.prompt || 'natural';
                const fullPrompt = `Voice Task: Speak as a native ${mainLang} speaker. 
                Sub-dialect/Accent: ${subLang}. 
                Mood/Style: ${stylePrompt}. 
                Text: ${text}`;

                const payload = {
                    contents: [{ parts: [{ text: fullPrompt }] }],
                    generationConfig: {
                        responseModalities: ["AUDIO"],
                        speechConfig: { voiceConfig: { prebuiltVoiceConfig: { voiceName: selectedVoice } } }
                    },
                    model: "gemini-2.5-flash-preview-tts"
                };

                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    const result = await response.json();
                    const audioData = result.candidates?.[0]?.content?.parts?.[0]?.inlineData;

                    if (!audioData) throw new Error('API Error');

                    const binaryString = atob(audioData.data);
                    const pcm16 = new Int16Array(binaryString.length / 2);
                    for (let i = 0; i < binaryString.length; i += 2) {
                        pcm16[i / 2] = (binaryString.charCodeAt(i + 1) << 8) | binaryString.charCodeAt(i);
                    }

                    const sampleRate = parseInt(audioData.mimeType.match(/rate=(\d+)/)?.[1] || "24000");
                    const mp3Blob = encodeMp3(pcm16, sampleRate);
                    setAudioUrl(URL.createObjectURL(mp3Blob));
                    setIsGenerating(false);
                } catch (err) {
                    setError("Gagal menghasilkan suara. Silakan coba beberapa saat lagi.");
                    setIsGenerating(false);
                }
            };

            return (
                <div className="min-h-screen p-4 md:p-10 flex flex-col items-center">
                    <div className="max-w-6xl w-full">
                        <header className="flex flex-col md:flex-row items-center justify-between mb-10 gap-6">
                            <div className="flex items-center gap-5">
                                <div className="bg-orange-500 p-4 rounded-3xl shadow-2xl shadow-orange-500/30">
                                    <Icon name="Mic2" className="w-8 h-8 text-white" />
                                </div>
                                <div>
                                    <h1 className="text-3xl font-black tracking-tight">
                                        <span className="text-orange-500">Mbah</span>
                                        <span className="text-white">Klowor</span> 
                                        <span className="text-white/60 ml-2 text-xl font-light">AI Voice Over Studio</span>
                                    </h1>
                                    <p className="text-[10px] font-bold text-gray-500 tracking-[0.4em] uppercase">Narrative Excellence Studio</p>
                                </div>
                            </div>
                        </header>

                        <div className="grid grid-cols-1 lg:grid-cols-12 gap-8">
                            <div className="lg:col-span-8 space-y-6">
                                <div className="glass-card rounded-[2.5rem] p-8 shadow-2xl relative">
                                    <textarea
                                        className="w-full h-[460px] bg-transparent border-none focus:ring-0 text-2xl leading-relaxed resize-none custom-scrollbar font-medium placeholder-gray-800"
                                        value={text}
                                        onChange={(e) => setText(e.target.value)}
                                        placeholder="Tuliskan Kata/Kalimat Disini..."
                                    />
                                    {isGenerating && (
                                        <div className="absolute inset-0 bg-black/80 backdrop-blur-xl flex flex-col items-center justify-center rounded-[2.5rem] z-50">
                                            <div className="w-20 h-20 border-4 border-orange-500/10 border-t-orange-500 rounded-full animate-spin mb-6"></div>
                                            <p className="font-black text-xl tracking-[0.2em] text-white uppercase">GENERATE SUARA...</p>
                                        </div>
                                    )}
                                </div>

                                <div className="flex flex-wrap gap-4">
                                    <button 
                                        onClick={generateVoice}
                                        disabled={isGenerating}
                                        className="flex-1 md:flex-none px-12 py-5 bg-orange-600 hover:bg-orange-500 rounded-2xl font-black text-lg transition-all active:scale-95 disabled:opacity-50 flex items-center justify-center gap-3 shadow-xl shadow-orange-600/20 uppercase"
                                    >
                                        <Icon name="Zap" className="w-6 h-6 fill-white" /> GENERATE SEKARANG
                                    </button>
                                    
                                    {audioUrl && (
                                        <div className="flex gap-3 w-full md:w-auto">
                                            <button onClick={() => audioRef.current.play()} className="flex-1 px-10 py-5 bg-white/5 hover:bg-white/10 rounded-2xl font-bold flex items-center justify-center gap-2 border border-white/10 uppercase">
                                                <Icon name="PlayCircle" className="w-6 h-6" /> PLAY
                                            </button>
                                            <button onClick={() => { const a = document.createElement('a'); a.href = audioUrl; a.download = 'mbah-klowor-narrative.mp3'; a.click(); }} 
                                                className="flex-1 px-8 py-5 bg-green-500/10 text-green-400 border border-green-500/20 rounded-2xl font-bold flex items-center justify-center gap-2 uppercase">
                                                <Icon name="Download" className="w-6 h-6" /> DOWNLOAD
                                            </button>
                                        </div>
                                    )}
                                </div>
                                {audioUrl && <audio ref={audioRef} src={audioUrl} className="hidden" />}
                                {error && <div className="p-4 bg-red-500/10 text-red-500 rounded-2xl text-xs font-bold border border-red-500/20">{error}</div>}
                            </div>

                            <div className="lg:col-span-4 space-y-6">
                                <div className="glass-card rounded-3xl p-6 border-orange-500/10">
                                    <h3 className="text-[10px] font-black uppercase text-gray-500 mb-5 tracking-widest flex items-center gap-2">
                                        <Icon name="Globe" className="w-4 h-4 text-orange-500" /> Bahasa & Logat
                                    </h3>
                                    <div className="space-y-5">
                                        <div className="flex p-1 bg-black/40 rounded-xl border border-white/5">
                                            {Object.keys(languageMap).map(lang => (
                                                <button 
                                                    key={lang}
                                                    onClick={() => setMainLang(lang)}
                                                    className={`flex-1 py-2.5 rounded-lg text-[10px] font-black uppercase transition-all ${mainLang === lang ? 'bg-orange-500 text-white shadow-lg' : 'text-gray-500 hover:text-white'}`}
                                                >
                                                    {lang}
                                                </button>
                                            ))}
                                        </div>
                                        <select 
                                            className="w-full bg-black/40 border border-white/10 rounded-xl p-4 text-sm font-bold outline-none cursor-pointer focus:border-orange-500/50"
                                            value={subLang}
                                            onChange={(e) => setSubLang(e.target.value)}
                                        >
                                            {languageMap[mainLang].map(sub => <option key={sub} className="bg-[#0a0c10]">{sub}</option>)}
                                        </select>
                                    </div>
                                </div>

                                <div className="glass-card rounded-3xl p-6">
                                    <h3 className="text-[10px] font-black uppercase text-gray-500 mb-5 tracking-widest flex items-center gap-2">
                                        <Icon name="Sparkles" className="w-4 h-4 text-orange-500" /> Gaya Narasi
                                    </h3>
                                    <div className="grid grid-cols-2 gap-3">
                                        {styles.map(s => (
                                            <button 
                                                key={s.name}
                                                onClick={() => setStyle(s.name)}
                                                className={`p-4 rounded-2xl border text-[9px] font-black uppercase transition-all flex flex-col items-center gap-3 ${style === s.name ? 'bg-orange-500/20 border-orange-500 text-orange-500' : 'bg-white/5 border-transparent text-gray-500 hover:bg-white/10'}`}
                                            >
                                                <span className="text-2xl">{s.icon}</span>
                                                {s.name}
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                <div className="glass-card rounded-3xl p-6">
                                    <h3 className="text-[10px] font-black uppercase text-gray-500 mb-5 tracking-widest flex items-center gap-2">
                                        <Icon name="UserCheck" className="w-4 h-4 text-orange-500" /> Voice Character ({mainLang})
                                    </h3>
                                    <div className="space-y-3">
                                        {voiceDatabase[mainLang].map(v => (
                                            <button 
                                                key={v.id}
                                                onClick={() => setSelectedVoice(v.id)}
                                                className={`w-full flex items-center gap-4 p-4 rounded-2xl transition-all border ${selectedVoice === v.id ? 'bg-orange-500/10 border-orange-500 text-white shadow-lg' : 'bg-transparent border-transparent hover:bg-white/5 text-gray-500'}`}
                                            >
                                                <span className="text-3xl bg-black/40 p-2 rounded-2xl">{v.avatar}</span>
                                                <div className="text-left">
                                                    <div className="font-black text-xs">{v.name}</div>
                                                    <div className="text-[9px] font-medium opacity-50 uppercase tracking-tight">{v.type}</div>
                                                </div>
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <footer className="mt-16 mb-8 text-[10px] font-bold text-gray-800 tracking-[0.4em] uppercase">
                        &copy; 2026 MbahKlowor AI Voice Over Generator Studio â€¢
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>


